<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* Add your styles here */
 /* Add your styles here */

 .topnav {
  overflow: hidden;
  background-color: #333;
  margin-top: -9px;
    margin-left: -9px;
    width: 1550px;
}

.topnav a {
  float: left;
  color: #f2f2f2;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
  font-size: 17px;
}

.topnav a:hover {
  background-color: #ddd;
  color: black;
}

.topnav a.active {
  background-color: #aa0404;
  color: white;
}



 #addItem {
      margin-top: 20px;
    }

    #invoice {
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      background-color: #f7f7f7;
      border: 1px solid #ccc;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      border-radius: 8px;
      position: relative;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      border: 2px solid black;
    }

    th,
    td {
      border: 1px solid #000000;
      padding: 12px;
      text-align: left;
    }

    th {
      background-color: #3498db;
      color: #000000;
      border: 1px solid black;
    }

    #total {
      margin-top: -20px;
      /* text-align: right; */
      font-weight: bold;
      color: #ff2323;
      margin-left: 706px;
    }

    #addItem input,
    #addItem button {
      padding: 8px;
      margin-right: 8px;
      border: none;
      text-align: center;
    }

    #addItem button {
      background-color: #2ecc71;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    #addItem button:hover {
      background-color: #27ae60;
    }

    @media print {
      body * {
        visibility: hidden;
      }

      #invoice,
      #invoice * {
        visibility: visible;
      }

      #invoice {
        position: absolute;
        left: 0;
        top: 0;
        border: 1px solid white;
      }

      #printButton {
        display: none;
      }
    }

   #print-bill{
    margin-left: 712px;
    font-size: x-large;
    background-color: white;
    color: black;
    font-weight: bold;
    border: 2px solid black;
    border-radius: 9px;
   }

   #print-bill:hover{
    background-color: rgb(194, 81, 24);
    color: rgb(255, 253, 253);
   }

    @media print {
      body * {
        visibility: hidden;
      }

      #invoice,
    #invoice * {
      visibility: visible;
    }

    #invoice {
      position: relative;
      border: 1px solid white;
      box-shadow: none;
      margin: 0;
      padding: 0;
      background-color: #f7f7f7;
    }

    #addItem, #editModal, #modalOverlay {
      display: none;
    }

    table {
      border: 2px solid black;
    }

    th, td {
      border: 1px solid #000000;
      padding: 0px;
      text-align: left;
      font-size: smaller;
    }

    th {
      background-color: #3498db;
      color: #000000;
      border: 1px solid black;
    }

    #total {
      margin-top: -40px;
       text-align: right; 
      font-weight: bold;
      color: #ff2323;
      margin-right: 12px;
    }

    #squareFeetTotal {
      margin-right: 550px;
      margin-top: -40px;
    }                                              

    #squareFeetTotal strong {
        margin-right: 190px;
      
    }
  }
  </style>
  <title>Marble Tiles Invoice</title>
</head>

<body>

  <div class="topnav">
		<a class="active" href="home.html">Home</a>
		<a href="gst.html">Gst Bill</a>
		<a href="challan.html">Challan</a>
		<a href="excel.html">Daily Estimate Bill Records</a>
		<a href="inventory.html">Inventory</a>
		<a href="self.html">Self Daily Bill Records</a>
		<a href="search.html">Search the product</a>
    <a href="barcode.html">Generate Barcode</a>
	  </div>

    <div id="addItem">
        <select id="itemSelect">
          <option value="granite">Granite</option>
          <option value="marble">Marble</option>
          <option value="kadappa">Kadappa</option>
          <option value="molding">Molding</option>
          <option value="dp">DP</option>
          <option value="uncut granite">Uncut Granite</option>
          <option value="tiles">Tiles</option>
          <option value="sanitary">sanitary</option>

        </select>
        <input type="text" id="description" placeholder="Description">
        <input type="number" id="quantity" placeholder="Quantity">
        <input type="number" id="rate" placeholder="Rate">
        <button onclick="addItem()">Add Item</button>
        <button onclick="addExtraRow(); updateTotal();">Add Extra Row</button>
      </div>

     
  <div id="invoice">
    <div id="container1" style="border: 2px solid black;" > 
    <!-- Remaining HTML content is the same -->
     <h1 style="text-align: center; color: rgb(0, 0, 0); background-color: red;">ESTIMATE</h1>
<hr>
    <!-- Bill No and Date section -->
    <div id="billInfo" style="margin-left:12px;">
        <label for="billNumber" style="color: black;
        font-weight: bold;">Bill No:</label>
        <input type="text" id="billNumber" placeholder="Enter Bill No" style="border: none;">
        <label for="billNumber" style="margin-left: 291px; color: black;
        font-weight: bold;">Bill No:</label>
        <input type="text" id="billNumber" placeholder="Enter Bill No" style="border: none;">
      </div>
  
      <div id="date" style="margin-right: 12px; margin-top: 19px;">
        <label for="currentDate1" style="margin-left: 29px; color: black;
        font-weight: bold;">Date:</label>
        <span id="currentDate1"></span>
        <label for="currentDate2" style="margin-left: 406px; color: black;
        font-weight: bold;">Date:</label>
        <span id="currentDate2"></span>
      </div>
 <hr>
      <!-- Customer details section -->
      <div id="customerInfo" style="margin-top: 23px;">
        <label for="customerName" style="color: black;
        font-weight: bold;">Customer Name:</label>
        <input type="text" id="customerName" placeholder="Enter Customer Name" style="border: none;">
        <label for="mobileNumber" style="margin-left: 193px; color: black;
        font-weight: bold;">Mobile Number:</label>
        <input type="text" id="mobileNumber" placeholder="Enter Mobile Number" style="border: none;">
      </div>



    <table>
      <thead>
        <tr>
          <th>Sr.No.</th>
          <th>Name of products / Services</th>
          <th>Quantity</th>
          <th>Rate</th>
          <th>Square Feet</th>
          <th>Amount</th>
        </tr>
      </thead>
      <tbody id="invoiceItems">
        <!-- Invoice items will be added here dynamically -->
      </tbody>
    </table>


    <!-- Add this div below the existing table -->
<div id="squareFeetTotal" style=" margin-left: 570px; margin-top: 10px;">
    <strong>Total: </strong><span id="invoiceSquareFeetTotal" style="margin-left: 12px;">0.00</span>
  </div>
    <div id="total">Total: ₹<span id="invoiceTotal">0.00</span></div>
    <br>
    <div id="discountMessage" style="margin-left: 10px; margin-top: -45px; font-weight: bold; color: #e74c3c; display: none; margin-bottom: 15px;">
      Discount Applied: ₹<span id="appliedDiscount">0.00</span>
      <br>
      <span id="invoiceDiscountedTotal" style="display: none;">0.00</span>
    </div>
  </div>
  </div>
  <button id="print-bill">Print Bill</button>


<!-- Add this button below your existing content in the body -->
<button id="sendToSummaryButton" style="margin-left: 54px;
padding: 6px;
border: 2px solid green;
background-color: #2ecc71;
color: white;
border-radius: 6px;
cursor: pointer;">Save Data</button>

<!-- Add this button below your existing content in the body -->
<button id="applyDiscountButton" style="margin-left: 10px; padding: 6px; border: 2px solid #e74c3c; background-color: #e74c3c; color: white; border-radius: 6px; cursor: pointer;">Apply Discount</button>
<!-- Add this div for displaying the discount message and discounted total -->


  <script>
    document.addEventListener('DOMContentLoaded', function () {
       // Dummy data for demonstration
       const invoiceData = {
        invoiceNumber: 'INV001',
        invoiceDate: '2023-12-25',
        items: [],
      };

   // Add event listener to the new discount button
   const applyDiscountButton = document.getElementById('applyDiscountButton');
    applyDiscountButton.addEventListener('click', function () {
      applyDiscount();
    });

    // Function to apply discount
    function applyDiscount() {
      const discountValue = parseFloat(prompt('Enter discount value in Rs:'));
      if (!isNaN(discountValue)) {
        const appliedDiscountContainer = document.getElementById('appliedDiscount');
        const discountedTotalContainer = document.getElementById('invoiceDiscountedTotal');
        const totalContainer = document.getElementById('invoiceTotal');
        const total = parseFloat(totalContainer.textContent) || 0;

        // Display the discount message
        appliedDiscountContainer.textContent = discountValue.toFixed(2);
        discountedTotalContainer.textContent = (total - discountValue).toFixed(2);
        document.getElementById('discountMessage').style.display = 'block';

        // Update the totalContainer with the discounted total
        totalContainer.textContent = discountedTotalContainer.textContent;
      } else {
        alert('Please enter a valid discount value.');
      }
    }

     // NEW JAVASCRIPT FOR SELF HTML

 // Add event listener to the new button
 const sendToSummaryButton = document.getElementById('sendToSummaryButton');
      sendToSummaryButton.addEventListener('click', function () {
        sendToSummaryTable();
      });

      // Function to send data to the summary table
      function sendToSummaryTable() {
        const currentDateElement1 = document.getElementById('currentDate1');
        const currentDate2 = document.getElementById('currentDate2');
        const billNumber = document.getElementById('billNumber');
        const totalAmount = document.getElementById('invoiceTotal');
        const customerName = document.getElementById('customerName');

        // Create an object with the data
        const data = {
          date: currentDateElement1.textContent,
          billNo: billNumber.value,
          total: totalAmount.textContent,
          customerName: customerName.value
        };

        // Call a function to send the data to the other HTML table
        sendDataToSummaryTable(data);
      }

      function sendDataToSummaryTable(data) {
  // Retrieve existing data from localStorage
  let existingData = JSON.parse(localStorage.getItem('summaryData')) || [];

  // Ensure that existingData is an array
  if (!Array.isArray(existingData)) {
    // If it's not an array, create a new array and add the existingData to it
    existingData = [existingData];
  }

  // Add new data to the existing array
  existingData.push(data);

  // Save the updated array back to localStorage
  localStorage.setItem('summaryData', JSON.stringify(existingData));

  // Optionally, redirect to the summary table page after sending data
  window.location.href = 'self.html';
}

//TILL HERE

     
      
     // Auto-generate the current date and display it for the first section
const currentDateElement1 = document.getElementById('currentDate1');
const currentDate1 = new Date().toLocaleDateString('en-GB', { day: '2-digit', month: '2-digit', year: 'numeric' });
currentDateElement1.textContent = currentDate1;

// Auto-generate the current date and display it for the second section
const currentDateElement2 = document.getElementById('currentDate2');
const currentDate2 = new Date().toLocaleDateString('en-GB', { day: '2-digit', month: '2-digit', year: 'numeric' });
currentDateElement2.textContent = currentDate2;



      // print

      //Add event listener for the print button
    const printButton = document.getElementById('print-bill');
    printButton.addEventListener('click', function() {
      window.print();
    });


  

    function renderInvoice() {
  const invoiceItemsContainer = document.getElementById('invoiceItems');
  const totalContainer = document.getElementById('invoiceTotal');
  const squareFeetTotalContainer = document.getElementById('invoiceSquareFeetTotal'); // New line

  // Clear existing items
  invoiceItemsContainer.innerHTML = '';

  // Recalculate total
  let total = 0;
  let sanitarySquareFeetTotal = 0; // Separate variable for 'sanitary' items
  let otherSquareFeetTotal = 0;    // Separate variable for other items

  // Add items to the invoice and calculate the total
  invoiceData.items.forEach((item, index) => {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${index + 1}</td>
      <td>${item.item} (${item.description})</td>
      <td>${item.quantity}</td>
      <td>${item.rate}</td>
      <td>${item.squareFeet}</td>
      <td>${item.amount.toFixed(2)}</td>
    `;
    invoiceItemsContainer.appendChild(row);

    total += item.amount;

    // Separate the calculation of total square footage for 'sanitary' and other items
    if (item.item.toLowerCase() === 'sanitary') {
      sanitarySquareFeetTotal += item.squareFeet;
    } else {
      otherSquareFeetTotal += item.squareFeet;
    }
  });

  // Update the total amount in the invoice
  totalContainer.textContent = total.toFixed(2);

  // Update the total square footage, considering only other items
  squareFeetTotalContainer.textContent = otherSquareFeetTotal.toFixed(2);
}

      // Function to add items
      window.addItem = function () {
  const itemSelect = document.getElementById('itemSelect');
  const descriptionInput = document.getElementById('description');
  const quantityInput = document.getElementById('quantity');
  const rateInput = document.getElementById('rate');

  const newItem = {
    item: itemSelect.value,
    description: descriptionInput.value,
    quantity: parseFloat(quantityInput.value),
    rate: parseFloat(rateInput.value),
  };

  // Customize calculation based on the selected item
  switch (newItem.item.toLowerCase()) {
    case 'granite':
      // Ensure length and breadth are rounded up to the next multiple of 3 for Granite
      const dimensionsGranite = newItem.description.split('x').map(Number);
      const roundedDimensionsGranite = dimensionsGranite.map(dimension => Math.ceil(dimension / 3) * 3);
      // Calculate square feet for granite by considering quantity
      newItem.squareFeet = (roundedDimensionsGranite.reduce((acc, val) => acc * val, 1)) / 144 * newItem.quantity;
      break;
    case 'kadappa':
     // Ensure length and breadth are multiples of 6 for Kadappa
     const dimensionsKadappa = newItem.description.split('x').map(Number);
      const adjustedDimensionsKadappa = dimensionsKadappa.map(dimension => {
        const multiple = 6;
        const nextMultiple = Math.ceil(dimension / multiple) * multiple;
        return nextMultiple === dimension ? nextMultiple + multiple : nextMultiple;
      });
      // Calculate square feet for Kadappa by considering quantity
      newItem.squareFeet = (adjustedDimensionsKadappa.reduce((acc, val) => acc * val, 1)) / 144 * newItem.quantity;
      break;
      case 'molding':
  // Assuming the first value is the length for molding
  const lengthMolding = parseFloat(newItem.description.split('x')[0]);
  const runningFeet = Math.ceil(lengthMolding / 12) * newItem.quantity; // Calculate running feet
  newItem.squareFeet = runningFeet; // Each running foot is considered as 1 in square feet
  break;

  case 'marble':
  // Ensure length and breadth are rounded up to the next multiple of 3 for Marble
  const dimensionsMarble = newItem.description.split('x').map(Number);
  const roundedDimensionsMarble = dimensionsMarble.map(dimension => Math.ceil(dimension / 3) * 3);
  // Calculate square feet for marble by considering quantity
  newItem.squareFeet = (roundedDimensionsMarble.reduce((acc, val) => acc * val, 1)) / 144 * newItem.quantity;
  break;
   
  case 'dp':
  // Ensure length and breadth are rounded up to the next multiple of 3 for DP
  const dimensionsDP = newItem.description.split('x').map(Number);
  const roundedDimensionsDP = dimensionsDP.map(dimension => Math.ceil(dimension / 3) * 3);
  // Calculate square feet for DP by considering quantity
  newItem.squareFeet = (roundedDimensionsDP.reduce((acc, val) => acc * val, 1)) / 144 * newItem.quantity;
  break;

  case 'uncut granite':
  // Simple calculation for Uncut Granite: lengthxbredth/144xquantity = squarefeet
  const dimensionsUncutGranite = newItem.description.split('x').map(Number);
  // Calculate square feet for Uncut Granite by considering quantity and round to two decimal places
  newItem.squareFeet = ((dimensionsUncutGranite.reduce((acc, val) => acc * val, 1)) / 144 * newItem.quantity).toFixed(2);
  break;

  case 'tiles':
  // Simple calculation for Uncut Granite: lengthxbredth/144xquantity = squarefeet
  const dimensionstiles = newItem.description.split('x').map(Number);
  // Calculate square feet for Uncut Granite by considering quantity and round to two decimal places
  newItem.squareFeet = ((dimensionstiles.reduce((acc, val) => acc * val, 1)) / 144 * newItem.quantity).toFixed(2);
  break;

  case 'sanitary':
      // For sanitary, set square feet to 1 and calculate the amount based on quantity and rate only
      newItem.squareFeet = 1;
      break;

    default:
      // For other items, calculate square feet based on size (if available)
      const dimensions = newItem.description.split('x').map(Number);
      newItem.squareFeet = dimensions.reduce((acc, val) => acc * val, 1) / 144 || 1;

      // For other cases, quantity should not be considered twice for amount calculation
      newItem.quantity = 1;
  }

  // Set the product name including the description
  newItem.productName = `${newItem.item} (${newItem.description})`;

  // Calculate total for all items based on square feet and quantity
  newItem.total = newItem.squareFeet;

  // Calculate amount based on the square feet and rate, but only for the 'sanitary' case
  newItem.amount = newItem.item.toLowerCase() === 'sanitary' ? newItem.rate * newItem.quantity : newItem.rate * newItem.squareFeet;

  // Add the new item to the invoice data
  invoiceData.items.push(newItem);

  // Render the updated invoice
  renderInvoice();
};

});

window.addExtraRow = function () {
  const invoiceItemsContainer = document.getElementById('invoiceItems');

  const row = document.createElement('tr');
  row.innerHTML = `
    <td contenteditable="true">New</td>
    <td contenteditable="true">Row</td>
    <td contenteditable="true" oninput="updateAmount(this)">1</td>
    <td contenteditable="true" oninput="updateAmount(this)">0</td>
    <td contenteditable="true">0.00</td>
    <td contenteditable="true">0.00</td>
  `;

  invoiceItemsContainer.appendChild(row);
};

function updateAmount(input) {
  const quantityCell = input.parentElement.querySelector('td:nth-child(3)');
  const rateCell = input.parentElement.querySelector('td:nth-child(4)');
  const amountCell = input.parentElement.querySelector('td:nth-child(6)');

  const quantity = parseFloat(quantityCell.textContent) || 0;
  const rate = parseFloat(rateCell.textContent) || 0;
  const amount = quantity * rate;

  amountCell.textContent = amount.toFixed(2);

  // Update the total amount in the invoice for this row only
  updateRowTotal(input.parentElement);

  // Update the total amount in the invoice
  updateTotal();
}

function updateRowTotal(row) {
  const amountCell = row.querySelector('td:nth-child(6)');

  const amount = parseFloat(amountCell.textContent) || 0;

  // Update the total amount in the invoice for this row only
  const totalContainer = document.getElementById('invoiceTotal');
  let total = parseFloat(totalContainer.textContent) || 0;

  // Subtract the previous amount and add the new amount
  total = total - amount + parseFloat(amountCell.textContent);

  totalContainer.textContent = total.toFixed(2);
}

function updateTotal() {
  const invoiceItemsContainer = document.getElementById('invoiceItems');
  const totalContainer = document.getElementById('invoiceTotal');

  let total = 0;

  // Update the total amount for the entire invoice
  invoiceItemsContainer.querySelectorAll('tr').forEach((itemRow) => {
    const amount = parseFloat(itemRow.querySelector('td:nth-child(6)').textContent) || 0;
    total += amount;
  });

  // Update the total amount in the invoice
  totalContainer.textContent = total.toFixed(2);
}


     
  </script>

</body>

</html> 
